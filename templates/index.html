{% extends "base.html" %}
{% load reversetag %}

{%block head%}
  <style type="text/css">
    #rdf-content, #rdf-query, #rdf-query-result {
      font-family: monospace;
    }

    #footer {
      margin-top: 10px;
    }
  </style>
{%endblock%}

{%block content%}
  <div class="row">
    <div class="col-md-6">
      <h2>Load RDF content</h2>
      <form role = "form" action="{% reverse 'store.views.load' %}" method="POST">
        {% csrf_token %}

        <div class="form-group">
          <label for="rdf-content">RDF Content</label>
          <textarea rows = "15" class="form-control" name = "rdf-content" id="rdf-content" placeholder="Enter valid RDF content here"></textarea> 
        </div>
        <div class="form-group row">
          <div class="col-md-6">
            <label for="rdfType">RDF Type</label>
          </div>
          <div class="col-md-6 text-right">
            <div class="btn-group" data-toggle="buttons">
              <label class="type-selector btn btn-primary" id="xml">
                <input type="radio">
                XML
              </label>
              <label class="type-selector btn btn-primary active" id="n3">
                <input type="radio">
                N3 / Turtle
              </label>
            </div>
            <input id="rdf-type" name="rdf-type" type="hidden" value="n3"/>
          </div>
        </div>
        <div class="form-group">
          <button type="submit" class="btn btn-success col-md-offset-9 col-md-3">Save</button>
        </div>
      </form>
    </div>
    <div class="col-md-6">
      <h2>Query current RDF-database</h2>
      <form role = "form" action="{% reverse 'store.views.query' %}" method="POST">
        {% csrf_token %}

        <div class="form-group">
          <label for="rdf-query">SPARQL Query</label>
          <textarea rows = "15" class="form-control" name = "rdf-query" id="rdf-query" placeholder="Enter valid SPARQL query here"></textarea> 
        </div>

        <div class="form-group row">
          <div class="col-md-6">
            <label for="rdfType">RDF Type</label>
          </div>
          <div class="col-md-6 text-right">
            <div class="btn-group" data-toggle="buttons">
              <label class="output-type btn btn-primary active" id="xml">
                <input type="radio">
                XML
              </label>
              <label class="output-type btn btn-primary" id="json">
                <input type="radio">
                JSON
              </label>
            </div>
            <input id="output-type" name="output-type" type="hidden" value="xml"/>
          </div>
        </div>

        <div class="form-group">
          <button type="submit" class="btn btn-danger col-md-offset-9 col-md-3">GO!</button>
        </div>

      </form>
    </div>
  </div>

  {% if exception or result %}
    <div class="row" id="footer">
      {% if exception %}
        <h3>Error:</h3>
        <div class="alert alert-danger col-md-12">
          {{exception}}
          <button class="close" data-dismiss="alert">Ã—</button>
        </div>
      {% endif %}

      {% if result %}
        <h3>Result:</h3>
        <div id="rdf-query-result" class="col-md-12">
          <pre>{{ result }}</pre>
        </div>
      {% endif %}
    </div>
  {% endif %}
{%endblock %}


{% block script %}
  <script type="text/javascript">
    $(function() {
      $('.type-selector').click(function() {
        var val = $(this).attr("id");
        $("#rdf-type").attr("value", val);
      });
      $('.output-type').click(function() {
        var val = $(this).attr("id");
        $("#output-type").attr("value", val);
      });
    });
  </script>
{% endblock %}